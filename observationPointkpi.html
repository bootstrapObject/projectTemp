<!doctype html>
<html lang="en">
<!--[if IE 9 ]>
<html  lang="en" class="ie9">
<![endif]-->
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
<meta name="format-detection" content="telephone=no">
<meta charset="UTF-8">
<title>观察点KPI</title>
<!-- CSS -->
<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/animate.min.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
<link rel="stylesheet" href="css/form.css">
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/icons.css">
<link rel="stylesheet" href="css/generics.css">
<link rel="stylesheet" href="css/bstable/bootstrap-table.css">
<link rel="stylesheet" href="css/bstable/bootstrap-table-self.css">
<link rel="stylesheet" href="css/jedate.css">
<style>
.linedraw {
	background: rgba(0, 0, 0, 0.22);
}
</style>
</head>
<body>
	<header id="header" class="media">
		<a href="" id="menu-toggle"></a>
		<a class="logo pull-left" 	href="index.html">
			<img src="images/logo.png" alt="logo">
		</a>
		<div class="media-body">
			<div class="media" id="top-menu">
				<div class="pull-left tm-icon">
					<a data-drawer="messages" class="drawer-toggle" href="">
						<i class="sa-top-message"></i>
						<span>时间回溯</span>
					</a>
				</div>
				<div class="pull-left tm-icon">
					<a data-drawer="notifications" class="drawer-toggle" href="">
						<i class="sa-top-updates"></i>
						<span>帮助</span>
					</a>
				</div>
				<div id="time" class="pull-right">
					<span id="hours"></span> : <span id="min"></span> : <span id="sec"></span>
				</div>
				<div class="media-body">
					<input type="text" class="main-search">
				</div>
			</div>
		</div>
	</header>
	<div class="clearfix"></div>
	<section id="main" class="p-relative" role="main">
		<!-- Sidebar -->
		<aside id="sidebar">
			<!-- Side Menu -->
			<ul class="list-unstyled side-menu">
				<li>
					<a class="sa-side-home" href="index.html">
						<span class="menu-item">首页</span>
					</a>
				</li>
			</ul>
		</aside>
		<!-- Content -->
		<section id="content" class="container">
			<!-- Messages Drawer时间回溯 -->
			<div id="messages" class="tile drawer animated">
				<div class="listview narrow">
					<div class="media">
						<a href="">时间回溯</a> <span class="drawer-close">&times;</span>
					</div>
					<div class="overflow" style="height: 254px">
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/1.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Nadin Jackson - 2 Hours ago</small><br>
								<a class="t-overflow" href="">Mauris consectetur urna nec
									tempor adipiscing. Proin sit amet nisi ligula. Sed eu
									adipiscing lectus</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/2.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">David Villa - 5 Hours ago</small><br>
								<a class="t-overflow" href="">Suspendisse in purus ut nibh
									placerat Cras pulvinar euismod nunc quis gravida. Suspendisse
									pharetra</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/3.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Harris worgon - On 15/12/2013</small><br>
								<a class="t-overflow" href="">Maecenas venenatis enim
									condimentum ultrices fringilla. Nulla eget libero rhoncus,
									bibendum diam eleifend, vulputate mi. Fusce non nibh pulvinar,
									ornare turpis id</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/4.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Mitch Bradberry - On
									14/12/2013</small><br> <a class="t-overflow" href="">Phasellus
									interdum felis enim, eu bibendum ipsum tristique vitae.
									Phasellus feugiat massa orci, sed viverra felis aliquet quis.
									Curabitur vel blandit odio. Vestibulum sagittis quis sem sit
									amet tristique.</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/1.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Nadin Jackson - On 15/12/2013</small><br>
								<a class="t-overflow" href="">Ipsum wintoo consectetur urna
									nec tempor adipiscing. Proin sit amet nisi ligula. Sed eu
									adipiscing lectus</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/2.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">David Villa - On 16/12/2013</small><br>
								<a class="t-overflow" href="">Suspendisse in purus ut nibh
									placerat Cras pulvinar euismod nunc quis gravida. Suspendisse
									pharetra</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/3.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Harris worgon - On 17/12/2013</small><br>
								<a class="t-overflow" href="">Maecenas venenatis enim
									condimentum ultrices fringilla. Nulla eget libero rhoncus,
									bibendum diam eleifend, vulputate mi. Fusce non nibh pulvinar,
									ornare turpis id</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/4.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Mitch Bradberry - On
									18/12/2013</small><br> <a class="t-overflow" href="">Phasellus
									interdum felis enim, eu bibendum ipsum tristique vitae.
									Phasellus feugiat massa orci, sed viverra felis aliquet quis.
									Curabitur vel blandit odio. Vestibulum sagittis quis sem sit
									amet tristique.</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/5.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Wendy Mitchell - On 19/12/2013</small><br>
								<a class="t-overflow" href="">Integer a eros dapibus,
									vehicula quam accumsan, tincidunt purus</a>
							</div>
						</div>
					</div>
					<div class="media text-center whiter l-100">
						<a href=""><small>VIEW ALL</small></a>
					</div>
				</div>
			</div>
			<!-- Notification Drawer帮助 -->
			<div id="notifications" class="tile drawer animated">
				<div class="listview narrow">
					<div class="media">
						<a href="">帮助</a> <span class="drawer-close">&times;</span>
					</div>
					<div class="overflow" style="height: 254px">
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/1.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Nadin Jackson - 2 Hours ago</small><br>
								<a class="t-overflow" href="">Mauris consectetur urna nec
									tempor adipiscing. Proin sit amet nisi ligula. Sed eu
									adipiscing lectus</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/2.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">David Villa - 5 Hours ago</small><br>
								<a class="t-overflow" href="">Suspendisse in purus ut nibh
									placerat Cras pulvinar euismod nunc quis gravida. Suspendisse
									pharetra</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/3.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Harris worgon - On 15/12/2013</small><br>
								<a class="t-overflow" href="">Maecenas venenatis enim
									condimentum ultrices fringilla. Nulla eget libero rhoncus,
									bibendum diam eleifend, vulputate mi. Fusce non nibh pulvinar,
									ornare turpis id</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/4.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Mitch Bradberry - On
									14/12/2013</small><br> <a class="t-overflow" href="">Phasellus
									interdum felis enim, eu bibendum ipsum tristique vitae.
									Phasellus feugiat massa orci, sed viverra felis aliquet quis.
									Curabitur vel blandit odio. Vestibulum sagittis quis sem sit
									amet tristique.</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/1.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">Nadin Jackson - On 15/12/2013</small><br>
								<a class="t-overflow" href="">Ipsum wintoo consectetur urna
									nec tempor adipiscing. Proin sit amet nisi ligula. Sed eu
									adipiscing lectus</a>
							</div>
						</div>
						<div class="media">
							<div class="pull-left">
								<img width="40" src="img/profile-pics/2.jpg" alt="">
							</div>
							<div class="media-body">
								<small class="text-muted">David Villa - On 16/12/2013</small><br>
								<a class="t-overflow" href="">Suspendisse in purus ut nibh
									placerat Cras pulvinar euismod nunc quis gravida. Suspendisse
									pharetra</a>
							</div>
						</div>
					</div>
					<div class="media text-center whiter l-100">
						<a href=""><small>VIEW ALL</small></a>
					</div>
				</div>
			</div>
			<!-- Breadcrumb -->
			<div class="block-area">
				<div class="table-responsive overflow">
					<div id="guanchapoint">
						<span class="block-title" style="padding: 0px 10px 0px;">观察点KPI</span>
					</div>
					<table id="table7">
					</table>
					<hr class="whiter m-t-20">
				</div>
				<div class="table-responsive overflow  m-b-20">
					<div id="userduan">
						<span class="block-title" style="padding: 0px 10px 0px;">用户端KPI</span>
					</div>
					<table id="userSidekpi"></table>
				</div>
				<div class="table-responsive overflow">
					<div id="serverduan">
						<span class="block-title" style="padding: 0px 10px 0px;">服务端KPI</span>
					</div>
					<table id="serverSidekpi"></table>
				</div>
			</div>
			<div class="block-area">
				<div class="drawpos" style="margin-left:-10px;margin-right: -20px;">
					<div class="pointline">
						<div class="modal fade in" id="addNew-event" tabindex="-1"
							role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content" style="background: #000;">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal"
											aria-hidden="true">&times;</button>
										<h4 class="modal-title" id="myModalLabel">选择日期</h4>
									</div>
									<div class="modal-body">
										<div class="form-horizontal">
											<div class="form-group">
												<label for="historyTime" class="col-md-2 control-label">
													历史时间段: </label>
												<div class="col-md-9">
													<select class="form-control" id="historyTime"
														style="background: rgba(0, 0, 0, 0.0);">
														<option>10分钟</option>
														<option>30分钟</option>
														<option>1小时</option>
														<option>2小时</option>
														<option>4小时</option>
													</select>
												</div>
											</div>
											<div class="form-group">
												<lable for="lineTimejg" class="col-md-2 control-label">线图点间隔:</lable>
												<div class="col-md-9">
													<select class="form-control" id="lineTimejg"
														style="background: rgba(0, 0, 0, 0.0);">
														<option>10秒</option>
														<option>1分钟</option>
														<option>10分钟</option>
														<option>1小时</option>
														<option>1天</option>
													</select>
												</div>
											</div>
											<div class="form-group">
												<lable class="col-md-2 control-label">开始时间:</lable>
												<div class="col-md-9">
													<input type="text"
														class="form-control input-sm workinput wicon"
														id="modalStarTime" readonly>
												</div>
											</div>
											<div class="form-group">
												<lable class="col-md-2 control-label">结束时间:</lable>
												<div class="col-md-9">
													<input type="text" class="form-control input-sm"
														id="modalEndtime" readonly>
												</div>
											</div>
										</div>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-default"
											data-dismiss="modal">关闭</button>
										<button type="button" class="btn btn-primary"
											data-dismiss="modal" id="subTimemodal"
											style="margin-right: 40px;">提交更改</button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6">
						<div class="linedraw" style="height: 32.2rem; position: relative;margin-left: 2px;margin-right: 8px;margin-top:10px;">
							<img src="../images/append.png" style="padding-top: 8em;"
								id="list-draw" class="center-block" data-toggle="modal"
								data-target="#listDraw">
							<div class="modal fade" id="listDraw" tabindex="-1" role="dialog"
								aria-labelledby="myModalLabel" aria-hidden="true">
								<div class="modal-dialog">
									<div class="modal-content">
										<div class="modal-header">
											<button type="button" class="close" data-dismiss="modal"
												aria-hidden="true">&times;</button>
											<h4 class="modal-title" id="myModalLabel2">绘图列表</h4>
										</div>
										<div class="modal-body" style="height: 300px; padding: 0px;">
											<div class="list-content"></div>
										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-default"
												data-dismiss="modal">关闭</button>
											<button type="button" class="btn btn-primary" id="list-save"
												style="margin-right: 10%;">确定</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- Older IE Message -->
		<!--[if lt IE 9]>
    <div class="ie-block">
        <h1 class="Ops">抱歉！</h1>
        <p>您正在使用一个过时的Internet Explorer版本，升级到以下任何Web浏览器，以便访问该网站的最大功能。 </p>
        <ul class="browsers">
            <li>
                <a href="http://www.google.cn/intl/zh-CN/chrome/browser/desktop/index.html">
                    <img src="img/browsers/chrome.png" alt="">
                    <div>Google Chrome</div>
                </a>
            </li>
            <li>
                <a href="http://www.firefox.com.cn/">
                    <img src="img/browsers/firefox.png" alt="">
                    <div>Mozilla Firefox</div>
                </a>
            </li>
            <li>
                <a href="http://www.oupeng.com/download">
                    <img src="img/browsers/opera.png" alt="">
                    <div>Opera</div>
                </a>
            </li>
            <li>
                <a href="https://www.apple.com/cn/safari/">
                    <img src="img/browsers/safari.png" alt="">
                    <div>Safari</div>
                </a>
            </li>
            <li>
                <a href="https://support.microsoft.com/zh-cn/help/17621/internet-explorer-downloads">
                    <img src="img/browsers/ie.png" alt="">
                    <div>Internet Explorer(New)</div>
                </a>
            </li>
        </ul>
        <p>升级你的浏览器更安全和更快的网络体验。 <br/>感谢你的支持...</p>
    </div>
    <![endif]-->
	</section>
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Library -->
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Bootstrap-table -->
	<script src="js/bstable/bootstrap-table.js"></script>
	<script src="js/bstable/bootstrap-table-zh-CN.js"></script>
	<script src="js/functions.js"></script>
	<script src="js/changebgsave.js"></script>
	<script src="js/sidebar.js"></script>
	<script src="js/jquery.jedate.js"></script>
	<script src="js/echarts/echarts.min.js"></script>
	<script src="js/echarts/theme/macarons.js"></script>
	<script src="customjs/echartUtil/data.format.js"></script>
	<script src="customjs/echartUtil/echart.util.js"></script>

	<script>
    $(function(){
		var selectRow = window.location.href.split("?")[1].split("&")[0].split("=")[1]-0,
			selectDataId = window.location.href.split("?")[1].split("&")[1].split("=")[1]-0;
        var obPointkpi = {
            clickTableRow:function(row,element){
                $(".tabRowClickbg").removeClass("tabRowClickbg");
                $(element).addClass("tabRowClickbg");
				$("#userSidekpi").bootstrapTable("showLoading");
				$("#serverSidekpi").bootstrapTable("showLoading");
				$(".fixed-table-loading").css("line-height",$(".fixed-table-loading").height()+"px");
                $.ajax({
                    url:"commonController/getNpmListRrdData.do",
                    type:"post",
                    data:{
                        "moduleId":11,
                        "watchPointId":row.id,
                        "starttime":1505892630,
                        "endtime":1505960881
                    },
                    dataType:"json",
                    success:function(data){
						$("#userSidekpi").bootstrapTable("hideLoading");
                        $("#userSidekpi").bootstrapTable("load",data);
                    }
                });
                $.ajax({
                    url:"commonController/getNpmListRrdData.do",
                    type:"post",
                    data:{
                        "moduleId":12,
                        "watchPointId":row.id,
                        "starttime":1505892630,
                        "endtime":1505960881
                    },
                    dataType:"json",
                    success:function(data){
						$("#serverSidekpi").bootstrapTable("hideLoading");
                        $("#serverSidekpi").bootstrapTable("load",data);
                    }
                })
            },
            modulkpi:function(userColumnurl,toolbartem,modolkpiurl,tableId,watchPointId,moduleId,starttime,endtime){
                $.ajax({
                    url:userColumnurl,
                    type:"post",
                    data:"",
                    dataType:"json",
                    success:function(data){
                        var columnsArry = [];
                        data.forEach(function(title){
                            if(title.columnen!="id"){
                                var colObjet = {
                                    field:title.columnen,
                                    title:title.columnzh+"<span data-columnId='"+title.id+"'></span>",
                                    sortable:true,
                                    visible:title.checked
                                };
                                columnsArry.push(colObjet);
                            }
                        });
                        $(tableId).bootstrapTable({
                            url:modolkpiurl,
                            queryParams:function(params){
                                return {
                                    "moduleId":moduleId,
                                    "watchPointId":watchPointId,
                                    "starttime":starttime,
                                    "endtime":endtime
                                }
                            },
                            toggle:"table",
                            toolbar:toolbartem,
                            pagination:true,
                            showColumns:true,
                            columns:columnsArry,
                            onClickRow:function(row,element){
                            	if(tableId=="#table7"){
									obPointkpi.clickTableRow(row,element);
                            		selectDataId = row.id;
                            		load();
                                }
                            }
                        });
                    }
                });
            },
            clickColumn:function(thisElm){
				thisElm.siblings(".dropdown-menu").find("input[type='checkbox']").on("click",function(){
					if($(this).attr("checked")){
						$(this).attr("checked",false);
						$.ajax({
							url:"userConfigure/unCheckedUserListColumn.do",
							type:"post",
							data:{
								columnId:$(this).siblings("span").attr("data-columnId")
							},
							dataType:"text",
							success:function(data){
							}
						})
					}else {
						$(this).attr("checked",true);
						$.ajax({
							url:"userConfigure/checkedUserListColumn.do",
							type:"post",
							data:{
								columnId:$(this).siblings("span").attr("data-columnId")
							},
							dataType:"text",
							success:function(data){
							}
						})
					}
				});
            }
        };
		/*-------用户刚刚进入此页面时触发的事件------------------*/
		obPointkpi.modulkpi("/watchpointController/getWatchpointUserListColumn.do",
				"#guanchapoint",
				"/commonController/getNpmListRrdData.do",
				"#table7",
				null,
				10);//观察点

		obPointkpi.modulkpi("/client/getClientUserListColumn.do",
				"#userduan",
				"/commonController/getNpmListRrdData.do",
				"#userSidekpi",
				selectDataId,
				11,
				1505892630,
				1505960881,
				1
		);//用户端
		obPointkpi.modulkpi("/serverManagement/getServerSideUserListColumn.do",
				"#serverduan",
				"/commonController/getNpmListRrdData.do",
				"#serverSidekpi",
				selectDataId,
				12,
				1505892630,
				1505960881,
				1
		);//服务端
		setTimeout(function(){
			if(selectRow>9){
				$("#table7").bootstrapTable('selectPage', Math.ceil((selectRow-0+1)/10));
				$("#table7 tbody tr").each(function(index,element){
					if($(element).attr("data-index")==selectRow){
						$(element).addClass("tabRowClickbg");
					}
				})
			}else {
				$("#table7 tbody tr").eq(selectRow).addClass("tabRowClickbg");
			}
		},600);


        /*-------------用户操作列的消失隐藏--------------------------*/
		$(document).one('click','button[data-toggle="dropdown"]',function(){
			if($(this).attr("aria-label")=="columns"){
				var idWord = $(this).parents(".columns").prev(".bs-bars").children("div").attr("id"),
						thisElm = $(this);
				switch (idWord){
					case "guanchapoint":
						obPointkpi.clickColumn(thisElm);
						break;
					case "userduan":
						obPointkpi.clickColumn(thisElm);
						break;
					case "serverduan":
						obPointkpi.clickColumn(thisElm);
						break;
				}
			}
		});
        var kpiName = [];
        var kpiNames = [];
        function load(){
        	$.ajax({
    				 url:"/viewConfig/getModuleConfig.do",
    				 type:"post",
    				 dataType:"json",
    				 data:{moduleId:10,busiId:selectDataId},
    				 success:function(data){
    				    $(".pointline").empty();
    					var plotId=null,plotTypeId=null,url=null,watchpointId=null;
    					var html = '';
    			    	for(var i= 0;i<data.graph.length;i++){
    			    		   kpiName.push(data.graph[i].plotId);
    			    			html = '<div class="draw" style="margin: 10px;width: 48%;float: left;">'
    				    		    +'<div class="title">'
    				    		    +'<h2 class="tile-title">图形</h2>'
    				    		    +'<div class="tile-config dropdown">'
    				    		    +'<a data-toggle="dropdown" class="tile-menu"></a>'
    				    		    +'<ul class="dropdown-menu pull-right text-right">'
    				    		    +'<li><a href="">Refresh</a></li>'
    				    		    +'<li><a href="#" style="cursor:pointer;" data-toggle="modal" data-target="#addNew-event">日期选择</a></li>'
    				    		    +'<li><a href="">Settings</a></li></ul>'
    				    		    +'</div>'
    				    		    +'</div>'
    				    		    +'<div class="linedraw">'
    				    			+'<div id=lineid'+i+' style="width:100%;height:30em;"></div>'
    				    			+'</div>'
    				    			+'</div>';
    				    		$(".pointline").append(html);
    				    		plotId=data.graph[i].plotId;
    				            plotTypeId=data.graph[i].plotTypeId;
    				    	    url=data.graph[i].urlPath;
    				    	    watchpointId=data.graph[i].watchpointId;
      				    	$.drawChart('lineid'+i+'',url,{
    								 "watchpointId":watchpointId,
    								 "plotId":plotId,
    								 "plotTypeId":plotTypeId
    							 }, {
    								 dataZoom: true
    							 });
    			    	}
    				 }
    			 });
        } 
        load();
        	   var str=null;
        	   var str1=null;
        	   var trs =null;
        	   function cli(){
        		   var tables =  '<table class="table">'+
				      '<thead style="background: rgb(255,255,255);display:block;border-bottom:1px solid #c0c0c0;"><tr>'+
				      '<th>Kpi名称</th>'+
				      '<th>图形</th>'+
				      '<th>数据</th>'+
				      '</tr></thead>'+
				      '<tbody id="table-list"  style="display:block;max-height:260px;overflow-y: scroll;"></tbody>'+
				      '</table>';
				     $(".list-content").append(tables);
				     var _width=$('#listDraw').width();
				     $('.list-content th:first-child').width(_width*0.7); 
				     $('.list-content th:nth-child(2)').width(_width*0.2);  
				     $('.list-content th:nth-child(3)').width(_width*0.2);
        			$("#list-draw").off("click").on("click",function(){
        				$.ajax({
        					 url:"/plot/getPlotByModuleId.do",
        					 type:"post",
        					 data:{ moduleId:10,},
        					 dataType:"json",
        					 success:function(data){
        						 $("#table-list").empty();
        						 for(var i=0; i<data.length; i++){
        								 if(data[i].graph==true ){
            								 str='<td><input id="test" name="test"  value="'+data[i].id+':'+ data[i].types[0].id +'" type="checkbox" style="opacity: 1;"></td>';
            								 $('.list-content td:nth-child(2)').width(_width*0.2);
            							 }else {
            								 str='<td></td>';
            							 }
            							 if(data[i].number==true){
            								 str1='<td><input type="checkbox" style="opacity: 1;"></td>';
            								 $('.list-content td:nth-child(3)').width(_width*0.2);
            							 }else{
            								 str1='<td></td>';
            							 }
            							  if(kpiNames==""){
            								 for(var j= 0;j<kpiName.length;j++){
                								 if(data[i].id ==kpiName[j]){
                									 str='<td><input  name="test"  value="'+data[i].id+':'+ data[i].types[0].id +'" type="checkbox" checked=checked style="opacity: 1;"></td>';
                    								 $('.list-content td:nth-child(2)').width(_width*0.2); 
                								 }
                								 
                							 }
            							 }else{
            								 for(var k= 0;k<kpiNames.length;k++){
                								 if(data[i].id ==kpiNames[k]){
                									 str='<td><input  name="test"  value="'+data[i].id+':'+ data[i].types[0].id +'" type="checkbox" checked=checked style="opacity: 1;"></td>';
                    								 $('.list-content td:nth-child(2)').width(_width*0.2); 
                								 }
                								 
                							 }
            							 } 
            							 
            							  trs = $('<tr>'+  
            							            '<td>'+ data[i].name +'</td>'+str+ str1 +
            							            '</tr>'); 
            							     $('.list-content td:first-child').width(_width*0.7); 
            								 $("#table-list").append(trs);
            							 }
        					 }
        				});
        			});
        		}
        		 cli();
        		 $("#list-save").click(function(){
        			 $(".pointline").empty();
        			 var listvalue=[];
        			 var listgragh =[]; 
        			 var plotId = null;
        			 var plotTypeId = null;
        			 var urls = null;
        			 var html = null;
        			 serie = [];
        			 $('input[name="test"]:checked').each(function(){ 
        				  listgragh.push($(this).val()); 
        				  }); 
        				  if(listgragh.length==0){
        					  alert("你还没有选择任何内容！");
        				  }else {
        					  var datas="{\"graph\":[";
        					  for(var j=0; j<listgragh.length;j++){
        						   listvalue=listgragh[j].split(":");
        						   plotId=listvalue[0];
        						   kpiNames.push(plotId);
        						   plotTypeId=listvalue[1];
        						   urls= "/watchpointController/getWatchpointGraphical.do";
        						   datas += '{';  
        						   datas+='"ipmCenterId":"'+ 0 +'",';
        						   datas+='"urlPath":"'+ urls +'",';
        						   datas+='"watchpointId":"'+ selectDataId +'",';
        						   datas+='"plotId":"'+ plotId +'",';
        						   datas+='"plotTypeId":"'+ plotTypeId +'"';
        						   datas += '}';
        						   datas += ',';
        						   html = '<div class="draw" style="margin: 10px;width: 48%;float: left;">'
       				    		    +'<div class="title">'
       				    		    +'<h2 class="tile-title">图形</h2>'
       				    		    +'<div class="tile-config dropdown">'
       				    		    +'<a data-toggle="dropdown" class="tile-menu"></a>'
       				    		    +'<ul class="dropdown-menu pull-right text-right">'
       				    		    +'<li><a href="">Refresh</a></li>'
       				    		    +'<li><a href="#" style="cursor:pointer;" data-toggle="modal" data-target="#addNew-event">日期选择</a></li>'
       				    		    +'<li><a href="">Settings</a></li></ul>'
       				    		    +'</div>'
       				    		    +'</div>'
       				    		    +'<div class="linedraw">'
       				    			+'<div id=abc'+j+' style="width:100%;height:30em;"></div>'
       				    			+'</div>'
       				    			+'</div>';
       				    		    $(".pointline").append(html);
            				        $.drawChart('abc'+j,urls,{
            								 "watchpointId":selectDataId,
            								 "plotId":plotId,
            								 "plotTypeId":plotTypeId
            							 },{
            								 dataZoom: true
            							 }); 
        				       }
        					  datas+="]}";
        					  var json = datas.substring(0, datas.length - 3) +"]}";
        					  $.ajax({
        						  url:"/viewConfig/updModuleConfig.do",
        		    			  type:"post",
        		    			  dataType:"json",
        		    			  data:{moduleId:10,busiId:selectDataId,content:json},
        		    			  success:function(data){
        		    				 /*  if(data.stauts==true){
        		    					  window.location.reload();
        		    				  } */
        		    			  }
        					  });
        			 }
        			$("#listDraw").modal("hide");
        		 }); 
    });
    
    ~function (){
        var start = {
            format: 'YYYY-MM-DD hh:mm:ss',
            maxDate: $.nowDate({DD:0}), //最大日期
            choosefun: function(elem, val, date){
                end.minDate = date; //开始日选好后，重置结束日的最小日期
                endDates();
            }
        };
        var end = {
            format: 'YYYY-MM-DD hh:mm:ss',
            maxDate:$.nowDate({DD:0}), //最大日期
            choosefun: function(elem, val, date){
                start.maxDate = date; //将结束日的初始值设定为开始日的最大日期
            }
        };
        //这里是日期联动的关键
        function endDates() {
            //将结束日期的事件改成 false 即可
            end.trigger = false;
            $("#modalEndtime").jeDate(end);
        }
        $('#modalStarTime').jeDate(start);
        $('#modalEndtime').jeDate(end);
        $("#subTimemodal").click(function(){
            console.log($("#historyTime").val());
            console.log($("#lineTimejg").val());
            console.log($("#modalStarTime").val());
            console.log($("#modalEndtime").val());
        });
    }();
</script>
</body>
</html>


